# Implementation Guide: Setting Up Project Analysis

> Step-by-step guide for adding the ANALYZE.md workflow to any project.

---

## What You're Setting Up

This system creates two directories in your project:

| Directory  | Purpose                                           | Who uses it          |
| ---------- | ------------------------------------------------- | -------------------- |
| `.agent/`  | Task backlog, analysis instructions, agent workflow | AI agents, developers |
| `.claude/` | Project conventions, rules, quick-reference        | AI agents (auto-loaded) |

The `.claude/` directory is special: tools like Claude Code and Claude projects automatically load `CLAUDE.md` into context at the start of every conversation. The `.agent/` directory is a structured task management system that any AI agent or developer can follow.

---

## Step 1: Create the Directory Structure

Run these commands from your project root:

```bash
# Create the .agent directory and tasks subfolder
mkdir -p .agent/tasks

# Create the .claude directory and rules subfolder
mkdir -p .claude/rules
```

Your project should now have:

```
your-project/
├── .agent/
│   └── tasks/           # Empty for now — will be populated by the analysis
├── .claude/
│   └── rules/           # Empty for now — will be populated by the analysis
├── src/                 # Your existing source code
├── ...                  # Your existing files
└── README.md
```

---

## Step 2: Add the ANALYZE.md File

Copy the `ANALYZE.md` file into the `.agent/` directory:

```bash
# If you have the file locally:
cp ANALYZE.md .agent/ANALYZE.md

# Or create it directly:
# Paste the full contents of ANALYZE.md into .agent/ANALYZE.md
```

**The file MUST be named exactly:** `.agent/ANALYZE.md`

This is the only file you create manually. Everything else is generated by the AI agent when it runs the analysis.

---

## Step 3: Update .gitignore (Optional but Recommended)

Decide what to commit and what to keep local:

### Option A: Commit everything (recommended for teams)

Add nothing to `.gitignore`. The full `.agent/` and `.claude/` directories are committed so all team members and AI agents share the same context.

### Option B: Keep task status local

If you don't want task status changes cluttering your git history:

```gitignore
# .gitignore

# Keep ANALYZE.md and task definitions in git, but ignore status changes
# (Not generally recommended — status tracking is useful in git)
```

### Option C: Keep .agent/ local, commit .claude/

If you only want the conventions committed (not the task backlog):

```gitignore
# .gitignore

# Agent task backlog (local only)
.agent/TASKS.md
.agent/tasks/
.agent/README.md

# Keep the analysis instructions in git
# .agent/ANALYZE.md is committed
```

**Recommended approach: Option A.** Commit everything. The task backlog is valuable project documentation, and `.claude/` rules should definitely be shared.

---

## Step 4: Run the Analysis

### Using Claude Code (CLI)

```bash
# From your project root:
claude

# Then in the Claude Code session:
> Read .agent/ANALYZE.md and follow all instructions to analyze this project. 
> Execute every phase in order. Generate all output files.
```

### Using Claude.ai (Chat Interface)

1. Start a new conversation or Claude Project
2. Upload or paste the contents of your entire project (or connect it via a Claude Project)
3. Say:

```
Read the .agent/ANALYZE.md file and follow all instructions to analyze 
this project. Execute every phase in order. Generate all output files.
```

### Using Claude Projects (Recommended for Large Projects)

1. Create a new Claude Project
2. Add your project files to the project knowledge
3. Add this to the project instructions:

```
When asked to analyze this project, follow the instructions in 
.agent/ANALYZE.md exactly. Execute all four phases and generate 
all output files.
```

4. Start a conversation and say: "Analyze this project"

### Using Any Other AI Agent

The ANALYZE.md file is agent-agnostic. Point any AI coding agent at it:

```
Follow the instructions in .agent/ANALYZE.md to analyze this project.
```

---

## Step 5: Verify the Output

After the analysis runs, your project should have:

```
your-project/
├── .agent/
│   ├── ANALYZE.md                    # Instructions (was already here)
│   ├── ADDITIONAL-RULES.md           # ✅ Generated — optional rule templates
│   ├── TASKS.md                      # ✅ Generated — task index
│   ├── README.md                     # ✅ Generated — agent workflow
│   └── tasks/
│       ├── A1-some-task.md           # ✅ Generated — individual tasks
│       ├── A2-another-task.md
│       ├── B1-depends-on-a1.md
│       └── ...
├── .claude/
│   ├── CLAUDE.md                     # ✅ Generated — project overview
│   └── rules/
│       ├── project.md                # ✅ Generated — structure rules
│       ├── code-style.md             # ✅ Generated — style rules
│       ├── testing.md                # ✅ Generated — testing rules
│       ├── security.md              # ✅ Generated — security rules
│       ├── quality.md               # ✅ Generated — complexity & quality rules
│       └── {{optional}}.md          # ✅ Generated — only if project has conventions
├── src/
└── ...
```

### Verification Checklist

Open each file and verify:

- [ ] `.agent/TASKS.md` — Has waves, task tables, dependency graph, and guardrails
- [ ] `.agent/README.md` — Has workflow steps with your project's actual build/test commands
- [ ] `.agent/tasks/` — Has one `.md` file per task, each with all required sections
- [ ] `.claude/CLAUDE.md` — Has quick reference with real commands, accurate project structure
- [ ] `.claude/rules/project.md` — Matches your actual directory structure
- [ ] `.claude/rules/code-style.md` — Matches your actual code style (spot-check against source)
- [ ] `.claude/rules/testing.md` — Matches your actual test patterns
- [ ] `.claude/rules/security.md` — Covers real security concerns for your project
- [ ] `.claude/rules/quality.md` — Has complexity limits, linter/formatter/type checker config, coverage policy, documentation requirements, and cognitive complexity examples in your project's language
- [ ] Additional rule files (api.md, database.md, etc.) — Only created for domains where the project has real conventions

---

## Step 6: Start Working Tasks

### For AI Agents

Point the agent at the workflow:

```
Read .agent/README.md for the workflow, then pick the first available 
task from .agent/TASKS.md and execute it.
```

Or be specific:

```
Execute task A1 from .agent/TASKS.md. Follow the implementation steps 
in .agent/tasks/A1-some-task.md.
```

### For Human Developers

1. Open `.agent/TASKS.md`
2. Pick an available task (status `[ ]`, dependencies met)
3. Open the task file in `.agent/tasks/`
4. Follow the branch → implement → test → PR workflow in `.agent/README.md`
5. Update status in TASKS.md when done

---

## Step 7: Maintain Over Time

### After Completing a Task

```bash
# In .agent/TASKS.md, change the status:
# | `[ ]`  | `A1` | ...     →     | `[x]`  | `A1` | ...
```

### After Completing a Wave

Consider re-running the analysis to find new issues:

```
Re-run Phase 1.4 (findings) and Phase 2 (prioritization) of 
.agent/ANALYZE.md. Keep completed tasks marked [x]. Add any 
new findings as new tasks with new IDs.
```

### After Major Changes

If the architecture, build system, or conventions change significantly:

```
Re-run the full .agent/ANALYZE.md analysis. Preserve completed task 
history. Update .claude/CLAUDE.md and .claude/rules/ to reflect 
current conventions.
```

---

## Directory & File Reference

### File Naming Rules

| File                        | Naming Rule                                                  |
| --------------------------- | ------------------------------------------------------------ |
| `.agent/ANALYZE.md`         | Exact name, uppercase. Never rename.                         |
| `.agent/ADDITIONAL-RULES.md`| Exact name, uppercase. Optional rule templates reference.    |
| `.agent/TASKS.md`           | Exact name, uppercase. Central index.                        |
| `.agent/README.md`          | Exact name, uppercase. Workflow guide.                       |
| `.agent/tasks/A1-slug.md`   | `{WaveLetter}{Number}-{lowercase-slug}.md` — 2-4 word slug  |
| `.claude/CLAUDE.md`         | Exact name, uppercase. Auto-loaded by Claude tools.          |
| `.claude/rules/name.md`     | Lowercase, hyphen-separated. Must match CLAUDE.md table.     |

### Why These Specific Directories?

| Directory  | Reason                                                                 |
| ---------- | ---------------------------------------------------------------------- |
| `.agent/`  | Dot-prefix keeps it out of the way. "agent" is tool-agnostic.          |
| `.claude/` | Claude Code and Claude Projects look for this directory automatically. |

### Why These Specific Files?

| File           | Reason                                                                    |
| -------------- | ------------------------------------------------------------------------- |
| `ANALYZE.md`   | Reusable instructions — kept so you can re-run analysis later.            |
| `TASKS.md`     | Central index — one place to see all work and status.                     |
| `README.md`    | Standard name for "start here" — agents and humans both recognize it.     |
| `CLAUDE.md`    | Claude's convention for project instructions. Auto-loaded into context.   |
| `rules/*.md`   | Separated by domain so agents only load what's relevant to current work.  |

---

## Troubleshooting

### Agent didn't generate all files

Re-prompt explicitly:

```
You missed generating some files. Check .agent/ANALYZE.md Phase 3 
and ensure ALL output files are created:
- .agent/TASKS.md
- .agent/README.md
- .agent/tasks/ (one file per task)
- .claude/CLAUDE.md
- .claude/rules/project.md
- .claude/rules/code-style.md
- .claude/rules/testing.md
- .claude/rules/security.md
- .claude/rules/quality.md
```

### Agent invented conventions that don't exist

Check `.claude/rules/` against your actual code. If a rule doesn't match reality:

```
Review .claude/rules/code-style.md against the actual codebase. 
Remove any rules that don't match observed patterns. Mark areas 
with no convention as "No established convention — recommended:".
```

### Tasks are too large

If tasks consistently exceed 8 files or 500 lines:

```
Review .agent/tasks/ and split any task estimated as L or larger 
into smaller sub-tasks. Each sub-task must independently pass 
build and tests.
```

### Build/test commands are wrong in generated files

Update them manually in:

1. `.claude/CLAUDE.md` → Quick Reference table
2. `.agent/TASKS.md` → Verification Commands Reference
3. `.agent/README.md` → Quick Start and Workflow sections
4. Each affected task file in `.agent/tasks/` → Verification Commands
5. `.claude/rules/quality.md` → Complexity limits, coverage policy, tooling commands

---

## Example: Fresh Project Setup

Here's the complete flow for a Node.js project:

```bash
# 1. Create directories
mkdir -p .agent/tasks .claude/rules

# 2. Add ANALYZE.md (copy it in)
cp ~/ANALYZE.md .agent/ANALYZE.md

# 3. Commit the initial structure
git add .agent/ANALYZE.md
git commit -m "chore: add project analysis framework"

# 4. Run the analysis (using Claude Code as example)
claude
> Read .agent/ANALYZE.md and follow all instructions to analyze this project.

# 5. Review the generated files
cat .claude/CLAUDE.md          # Check project overview
cat .agent/TASKS.md            # Check task backlog
ls .agent/tasks/               # Check individual tasks

# 6. Commit the generated analysis
git add .agent/ .claude/
git commit -m "chore: complete initial project analysis"

# 7. Start working on the first task
git checkout -b fix/a1-whatever-the-first-task-is
# ... follow .agent/tasks/A1-whatever.md ...
```
